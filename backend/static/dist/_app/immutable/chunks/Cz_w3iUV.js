import{j as Q,g as I,M as fe,N as G,y as le,O as L,P as ce,Q as q,i as ue,R as K,S as de,T as he,U as pe,V as ge,k as v,l as z,W as ve,X as Ee,Y,Z as D,_ as b,$ as w,a0 as _e,a1 as me,a2 as $,a3 as T,a4 as Z,a5 as ee,a6 as F,a7 as Ie,a8 as Te,a9 as je,aa as te,ab as Pe,ac as re,ad as Se,ae as Ce,E as Ae,af as we,ag as Ne,ah as Re,m as M,h as B,w as A,u as ne,ai as se,D as ae}from"./BjAeDMBy.js";import{B as Oe,j as ke,k as xe,m as H}from"./DRF5TCtt.js";function Ue(t,e){return e}function De(t,e,n){for(var o=[],g=e.length,c,l=e.length,i=0;i<g;i++){let E=e[i];ee(E,()=>{if(c){if(c.pending.delete(E),c.done.add(E),c.pending.size===0){var d=t.outrogroups;V(q(c.done)),d.delete(c),d.size===0&&(t.outrogroups=null)}}else l-=1},!1)}if(l===0){var a=o.length===0&&n!==null;if(a){var u=n,s=u.parentNode;Te(s),s.append(u),t.items.clear()}V(e,!a)}else c={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(c)}function V(t,e=!0){for(var n=0;n<t.length;n++)je(t[n],e)}var W;function Le(t,e,n,o,g,c=null){var l=t,i=new Map,a=(e&re)!==0;if(a){var u=t;l=v?D(te(u)):u.appendChild($())}v&&z();var s=null,E=fe(()=>{var f=n();return ue(f)?f:f==null?[]:q(f)}),d,h=!0;function P(){r.fallback=s,Me(r,d,l,e,o),s!==null&&(d.length===0?(s.f&T)===0?Z(s):(s.f^=T,y(s,null,l)):ee(s,()=>{s=null}))}var N=Q(()=>{d=I(E);var f=d.length;let R=!1;if(v){var O=ve(l)===Ee;O!==(f===0)&&(l=Y(),D(l),b(!1),R=!0)}for(var m=new Set,S=le,k=ce(),_=0;_<f;_+=1){v&&w.nodeType===_e&&w.data===me&&(l=w,R=!0,b(!1));var C=d[_],x=o(C,_),p=h?null:i.get(x);p?(p.v&&G(p.v,C),p.i&&G(p.i,_),k&&S.skipped_effects.delete(p.e)):(p=ye(i,h?l:W??=$(),C,x,_,g,e,n),h||(p.e.f|=T),i.set(x,p)),m.add(x)}if(f===0&&c&&!s&&(h?s=L(()=>c(l)):(s=L(()=>c(W??=$())),s.f|=T)),v&&f>0&&D(Y()),!h)if(k){for(const[oe,ie]of i)m.has(oe)||S.skipped_effects.add(ie.e);S.oncommit(P),S.ondiscard(()=>{})}else P();R&&b(!0),I(E)}),r={effect:N,items:i,outrogroups:null,fallback:s};h=!1,v&&(l=w)}function Me(t,e,n,o,g){var c=(o&Se)!==0,l=e.length,i=t.items,a=t.effect.first,u,s=null,E,d=[],h=[],P,N,r,f;if(c)for(f=0;f<l;f+=1)P=e[f],N=g(P,f),r=i.get(N).e,(r.f&T)===0&&(r.nodes?.a?.measure(),(E??=new Set).add(r));for(f=0;f<l;f+=1){if(P=e[f],N=g(P,f),r=i.get(N).e,t.outrogroups!==null)for(const p of t.outrogroups)p.pending.delete(r),p.done.delete(r);if((r.f&T)!==0)if(r.f^=T,r===a)y(r,null,n);else{var R=s?s.next:a;r===t.effect.last&&(t.effect.last=r.prev),r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),j(t,s,r),j(t,r,R),y(r,R,n),s=r,d=[],h=[],a=s.next;continue}if((r.f&F)!==0&&(Z(r),c&&(r.nodes?.a?.unfix(),(E??=new Set).delete(r))),r!==a){if(u!==void 0&&u.has(r)){if(d.length<h.length){var O=h[0],m;s=O.prev;var S=d[0],k=d[d.length-1];for(m=0;m<d.length;m+=1)y(d[m],O,n);for(m=0;m<h.length;m+=1)u.delete(h[m]);j(t,S.prev,k.next),j(t,s,S),j(t,k,O),a=O,s=k,f-=1,d=[],h=[]}else u.delete(r),y(r,a,n),j(t,r.prev,r.next),j(t,r,s===null?t.effect.first:s.next),j(t,s,r),s=r;continue}for(d=[],h=[];a!==null&&a!==r;)(u??=new Set).add(a),h.push(a),a=a.next;if(a===null)continue}(r.f&T)===0&&d.push(r),s=r,a=r.next}if(t.outrogroups!==null){for(const p of t.outrogroups)p.pending.size===0&&(V(q(p.done)),t.outrogroups?.delete(p));t.outrogroups.size===0&&(t.outrogroups=null)}if(a!==null||u!==void 0){var _=[];if(u!==void 0)for(r of u)(r.f&F)===0&&_.push(r);for(;a!==null;)(a.f&F)===0&&a!==t.fallback&&_.push(a),a=a.next;var C=_.length;if(C>0){var x=(o&re)!==0&&l===0?n:null;if(c){for(f=0;f<C;f+=1)_[f].nodes?.a?.measure();for(f=0;f<C;f+=1)_[f].nodes?.a?.fix()}De(t,_,x)}}c&&Pe(()=>{if(E!==void 0)for(r of E)r.nodes?.a?.apply()})}function ye(t,e,n,o,g,c,l,i){var a=(l&pe)!==0?(l&ge)===0?de(n,!1,!1):K(n):null,u=(l&he)!==0?K(g):null;return{v:a,i:u,e:L(()=>(c(e,a??n,u??g,i),()=>{t.delete(o)}))}}function y(t,e,n){if(t.nodes)for(var o=t.nodes.start,g=t.nodes.end,c=e&&(e.f&T)===0?e.nodes.start:n;o!==null;){var l=Ie(o);if(c.before(o),o===g)return;o=l}}function j(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}function ze(t,e,n,o,g,c){let l=v;v&&z();var i=null;v&&w.nodeType===Ce&&(i=w,z());var a=v?w:t,u=new Oe(a,!1);Q(()=>{const s=e()||null;var E=n||s==="svg"?we:null;if(s===null){u.ensure(null,null),H(!0);return}return u.ensure(s,d=>{if(s){if(i=v?i:E?document.createElementNS(E,s):document.createElement(s),ke(i,i),o){v&&xe(s)&&i.append(document.createComment(""));var h=v?te(i):i.appendChild($());v&&(h===null?b(!1):D(h)),o(i,h)}Ne.nodes.end=i,d.before(i)}v&&D(d)}),H(!0),()=>{s&&H(!1)}},Ae),Re(()=>{H(!0)}),l&&(b(!0),D(a))}class be{#e=M(B(localStorage.getItem("APP_TOKEN")));get token(){return I(this.#e)}set token(e){A(this.#e,e,!0)}#t=ne(()=>!!this.token);get isAuthenticated(){return I(this.#t)}set isAuthenticated(e){A(this.#t,e)}constructor(){se(()=>{ae(()=>{this.token?localStorage.setItem("APP_TOKEN",this.token):localStorage.removeItem("APP_TOKEN")})})}setToken(e){this.token=e}logout(){this.token=null}}const X=new be,He="/api";async function J(t,e,n,o){const g=X.token,c={"Content-Type":"application/json"};g&&(c.Authorization=`${g}`);const l={method:t,headers:c};n&&o?.projectId&&!o?.skipProjectId&&(n={...n,projectId:o.projectId}),n&&(l.body=JSON.stringify(n));let i=`${He}${e}`;if(t==="GET"&&o?.projectId&&!o?.skipProjectId){const u=e.includes("?")?"&":"?";i=`${i}${u}projectId=${o.projectId}`}const a=await fetch(i,l);if(a.status===401)throw X.logout(),window.location.href="/login",new Error("Unauthorized");if(!a.ok){const u=new Error(`API Error: ${a.statusText}`);throw u.status=a.status,u}return a.json()}const U={get:(t,e)=>J("GET",t,void 0,e),post:(t,e,n)=>J("POST",t,e,n),put:(t,e,n)=>J("PUT",t,e,n),delete:(t,e)=>J("DELETE",t,void 0,e)};class Je{#e=M(B([]));get projects(){return I(this.#e)}set projects(e){A(this.#e,e,!0)}#t=M(B(localStorage.getItem("CURRENT_PROJECT_ID")));get currentProjectId(){return I(this.#t)}set currentProjectId(e){A(this.#t,e,!0)}#r=M(!1);get loading(){return I(this.#r)}set loading(e){A(this.#r,e,!0)}#n=M(null);get error(){return I(this.#n)}set error(e){A(this.#n,e,!0)}#s=ne(()=>this.projects.find(e=>e.id===this.currentProjectId)||this.projects[0]||null);get currentProject(){return I(this.#s)}set currentProject(e){A(this.#s,e)}constructor(){se(()=>{ae(()=>{this.currentProjectId?localStorage.setItem("CURRENT_PROJECT_ID",this.currentProjectId):localStorage.removeItem("CURRENT_PROJECT_ID")})})}async loadProjects(){this.loading=!0,this.error=null;try{const e=await U.get("/projects");this.projects=e,(!this.currentProjectId||!this.projects.find(n=>n.id===this.currentProjectId))&&this.projects.length>0&&(this.currentProjectId=this.projects[0].id),localStorage.setItem("PROJECTS_CACHE",JSON.stringify(this.projects))}catch(e){const n=e instanceof Error?e.message:"Failed to load projects";this.error=n;const o=localStorage.getItem("PROJECTS_CACHE");o&&(this.projects=JSON.parse(o))}finally{this.loading=!1}}async createProject(e,n="gin"){const o=await U.post("/projects",{name:e,framework:n});return await this.loadProjects(),o}async getProjectWithToken(e){return await U.get(`/projects/${e}`)}selectProject(e){this.currentProjectId=e}initFromCache(){const e=localStorage.getItem("PROJECTS_CACHE");e&&(this.projects=JSON.parse(e))}}const Be=new Je;export{X as a,U as b,ze as c,Le as e,Ue as i,Be as p};
