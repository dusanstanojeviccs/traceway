import{r as yt}from"../chunks/hp4PFHFv.js";import{a as kt,b as Pt,p as St,e as $t,i as Dt}from"../chunks/Cz_w3iUV.js";import{f as I,i as q,a as o,c as k,s as P,t as pe}from"../chunks/DRF5TCtt.js";import{p as Ct,m as d,h as R,q as Rt,a as wt,g as e,u as w,c as u,r as c,w as t,f,s as n,n as S,t as re}from"../chunks/BjAeDMBy.js";import{c as g}from"../chunks/g5lWU4bW.js";import{p as We,c as Xe,t as Ze,a as ke,b as It,f as zt}from"../chunks/CDT9LSXp.js";import{g as Ft}from"../chunks/BOe3pJkQ.js";import{b as Ut,d as jt,T as Ue,a as J,c as Bt}from"../chunks/y6C-zUiM.js";import{L as et}from"../chunks/2O2paTqt.js";import{d as tt,c as rt,e as At,f as at,u as Lt,T as Ot}from"../chunks/DYapue6Z.js";import{a as ae,T as Mt}from"../chunks/PdIRTCrQ.js";import{E as ot}from"../chunks/CEa0NWkH.js";import{S as Nt}from"../chunks/PDIvjsiP.js";import{c as Pe}from"../chunks/zDxND3qM.js";import{P as Et}from"../chunks/BUOTwRzw.js";import{P as Vt}from"../chunks/DpxRarxq.js";import{r as je}from"../chunks/UIOQSdMs.js";import{g as qt,h as Jt,s as Gt}from"../chunks/X-i49s3k.js";const Ht=!1,Kt=({params:Se,url:l})=>{if(!kt.isAuthenticated)throw yt(302,"/login");return{task:Se.task,preset:l.searchParams.get("preset")||null,from:l.searchParams.get("from")||null,to:l.searchParams.get("to")||null}},yr=Object.freeze(Object.defineProperty({__proto__:null,load:Kt,prerender:Ht},Symbol.toStringTag,{value:"Module"}));var Yt=I('<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4"><div class="space-y-1"><p class="text-2xl font-semibold tracking-tight"> </p> <p class="text-xs text-muted-foreground">Average duration</p></div> <div class="space-y-1"><p class="text-2xl font-semibold tracking-tight"> </p> <p class="text-xs text-muted-foreground">Median duration</p></div> <div class="space-y-1"><p class="text-2xl font-semibold tracking-tight"> </p> <p class="text-xs text-muted-foreground">95th percentile</p></div> <div class="space-y-1"><p class="text-2xl font-semibold tracking-tight"> </p> <p class="text-xs text-muted-foreground">99th percentile</p></div> <div class="space-y-1"><p class="text-2xl font-semibold tracking-tight"> </p> <p class="text-xs text-muted-foreground">Average throughput</p></div></div>'),Qt=I('<div class="flex items-center justify-center py-8"><!></div>'),Wt=I("<!> <!> <!> <!> <!> <!>",1),Xt=I('<div class="flex items-center justify-center"><!></div>'),Zt=I("<!> <!> <!> <!> <!> <!>",1),er=I("<!> <!>",1),tr=I('<div class="flex flex-col gap-4 sm:flex-row sm:justify-between"><!> <div class="flex flex-col"><!></div></div> <!> <div class="rounded-md border overflow-hidden"><!></div> <!>',1),rr=I('<div class="space-y-6"><!></div>');function kr(Se,l){Ct(l,!0);const z=w(Ft);let _e=d(R([])),F=d(null),U=d(!0),he=d(""),$e=d(!1),xe=d(0),G=d(1),De=d(20),Be=d(0),Ce=d(0);function st(){if(l.data.preset&&At[l.data.preset]){const a=at(l.data.preset,e(z));return{preset:l.data.preset,from:a.from,to:a.to}}if(l.data.from&&l.data.to){const a=We(l.data.from,e(z)),i=We(l.data.to,e(z));if(a.isValid&&i.isValid)return{preset:null,from:a.toJSDate(),to:i.toJSDate()}}const r=at("24h",e(z));return{preset:"24h",from:r.from,to:r.to}}const oe=st();let se=d(R(oe.preset)),H=d(R(tt(oe.from))),K=d(R(tt(oe.to))),Te=d(R(rt(oe.from))),be=d(R(rt(oe.to)));function nt(r=!0){Lt(e(se)?{preset:e(se)}:{from:Oe(),to:Me()},{pushToHistory:r})}const Ae="task_detail",Le=qt(Ae,{field:"recorded_at",direction:"desc"});let ne=d(R(Le.field)),le=d(R(Le.direction));function Oe(){const[r,a]=(e(Te)||"00:00").split(":").map(Number),i=Xe({year:e(H).year,month:e(H).month,day:e(H).day,hour:r,minute:a},e(z));return Ze(i)}function Me(){const[r,a]=(e(be)||"23:59").split(":").map(Number),i=Xe({year:e(K).year,month:e(K).month,day:e(K).day,hour:r,minute:a},e(z));return Ze(i)}function lt(r,a,i){t(H,r.date,!0),t(Te,r.time,!0),t(K,a.date,!0),t(be,a.time,!0),t(se,i,!0),t(G,1),j()}async function j(r=!0){t(U,!0),t(he,""),t($e,!1),t(xe,0),nt(r);try{const a={fromDate:Oe(),toDate:Me(),orderBy:e(ne),sortDirection:e(le),pagination:{page:e(G),pageSize:e(De)}},i=await Pt.post(`/tasks/task?task=${encodeURIComponent(l.data.task)}`,a,{projectId:St.currentProjectId??void 0});t(_e,i.data||[],!0),t(F,i.stats||null,!0),t(Be,i.pagination.total,!0),t(Ce,i.pagination.totalPages,!0)}catch(a){console.error(a),t(xe,a.status||0,!0),a.status===404?t($e,!0):t(he,a.message||"Failed to load data",!0)}finally{t(U,!1)}}function it(r){r>=1&&r<=e(Ce)&&(t(G,r,!0),j(!1))}function dt(r){t(De,r,!0),t(G,1),j(!1)}function Ne(r){const a=Jt(r,e(ne),e(le));t(ne,a.field,!0),t(le,a.direction,!0),Gt(Ae,a),t(G,1),j(!1)}Rt(()=>{j(!1)});var Re=rr(),ut=u(Re);{var ct=r=>{{let a=w(()=>Pe(je("/tasks"),"presets","from","to")),i=w(()=>decodeURIComponent(l.data.task));ot(r,{status:404,title:"Task Not Found",description:"The task you're looking for doesn't exist or has no recorded executions.",get onBack(){return e(a)},backLabel:"Back to Tasks",onRetry:()=>j(!1),get identifier(){return e(i)}})}},mt=r=>{var a=k(),i=f(a);{var ft=Y=>{{let ye=w(()=>e(xe)===400?400:e(xe)===422?422:400),ie=w(()=>Pe(je("/tasks"),"presets","from","to"));ot(Y,{get status(){return e(ye)},title:"Failed to Load Tasks",get description(){return e(he)},get onBack(){return e(ie)},backLabel:"Back to Tasks",onRetry:()=>j(!1)})}},vt=Y=>{var ye=tr(),ie=f(ye),Ee=u(ie);{let s=w(()=>decodeURIComponent(l.data.task)),T=w(()=>Pe(je("/tasks"),"presets","from","to"));Vt(Ee,{get title(){return e(s)},subtitle:"Task instances",get onBack(){return e(T)}})}var Ve=n(Ee,2),gt=u(Ve);Ot(gt,{onApply:lt,get fromDate(){return e(H)},set fromDate(s){t(H,s,!0)},get toDate(){return e(K)},set toDate(s){t(K,s,!0)},get fromTime(){return e(Te)},set fromTime(s){t(Te,s,!0)},get toTime(){return e(be)},set toTime(s){t(be,s,!0)},get preset(){return e(se)},set preset(s){t(se,s,!0)}}),c(Ve),c(ie);var qe=n(ie,2);{var pt=s=>{var T=Yt(),B=u(T),de=u(B),C=u(de,!0);c(de),S(2),c(B);var b=n(B,2),Q=u(b),Ie=u(Q,!0);c(Q),S(2),c(b);var $=n(b,2),A=u($),ue=u(A,!0);c(A),S(2),c($);var W=n($,2),L=u(W),ce=u(L,!0);c(L),S(2),c(W);var me=n(W,2),O=u(me),y=u(O);c(O),S(2),c(me),c(T),re((D,M,N,X,v)=>{P(C,D),P(Ie,M),P(ue,N),P(ce,X),P(y,`${v??""} rpm`)},[()=>ke(e(F).avgDuration),()=>ke(e(F).medianDuration),()=>ke(e(F).p95Duration),()=>ke(e(F).p99Duration),()=>e(F).throughput.toFixed(0)]),o(s,T)},_t=s=>{var T=k(),B=f(T);{var de=C=>{var b=Qt(),Q=u(b);et(Q,{size:"lg"}),c(b),o(C,b)};q(B,C=>{e(U)&&C(de)},!0)}o(s,T)};q(qe,s=>{e(F)?s(pt):s(_t,!1)})}var we=n(qe,2),ht=u(we);g(ht,()=>Bt,(s,T)=>{T(s,{children:(B,de)=>{var C=er(),b=f(C);{var Q=$=>{var A=k(),ue=f(A);g(ue,()=>jt,(W,L)=>{L(W,{children:(ce,me)=>{var O=k(),y=f(O);g(y,()=>Ue,(D,M)=>{M(D,{children:(N,X)=>{var v=Wt(),Z=f(v);ae(Z,{label:"Recorded At",sortField:"recorded_at",get currentSortField(){return e(ne)},get sortDirection(){return e(le)},onSort:te=>Ne(te),class:"w-[180px]"});var E=n(Z,2);ae(E,{label:"Duration",sortField:"duration",get currentSortField(){return e(ne)},get sortDirection(){return e(le)},onSort:te=>Ne(te),class:"w-[120px]"});var ee=n(E,2);ae(ee,{label:"Client IP",class:"w-[140px]"});var p=n(ee,2);ae(p,{label:"Server",class:"w-[120px]"});var V=n(p,2);ae(V,{label:"Version",class:"w-[100px]"});var fe=n(V,2);ae(fe,{label:"Context"}),o(N,v)},$$slots:{default:!0}})}),o(ce,O)},$$slots:{default:!0}})}),o($,A)};q(b,$=>{(e(U)||e(_e).length>0)&&$(Q)})}var Ie=n(b,2);g(Ie,()=>Ut,($,A)=>{A($,{children:(ue,W)=>{var L=k(),ce=f(L);{var me=y=>{var D=k(),M=f(D);g(M,()=>Ue,(N,X)=>{X(N,{children:(v,Z)=>{var E=k(),ee=f(E);g(ee,()=>J,(p,V)=>{V(p,{colspan:6,class:"h-48",children:(fe,te)=>{var ve=Xt(),ze=u(ve);et(ze,{size:"lg"}),c(ve),o(fe,ve)},$$slots:{default:!0}})}),o(v,E)},$$slots:{default:!0}})}),o(y,D)},O=y=>{var D=k(),M=f(D);{var N=v=>{Mt(v,{colspan:6,message:"No tasks found in this time range."})},X=v=>{var Z=k(),E=f(Z);$t(E,17,()=>e(_e),Dt,(ee,p)=>{var V=k(),fe=f(V);{let te=w(()=>Pe(`/tasks/${encodeURIComponent(decodeURIComponent(l.data.task))}/${e(p).id}`));g(fe,()=>Ue,(ve,ze)=>{ze(ve,{class:"cursor-pointer hover:bg-muted/50",get onclick(){return e(te)},children:(Tt,ar)=>{var Je=Zt(),Ge=f(Je);g(Ge,()=>J,(_,h)=>{h(_,{class:"text-muted-foreground",children:(x,ge)=>{S();var m=pe();re(Fe=>P(m,Fe),[()=>It(e(p).recordedAt,{timezone:e(z)})]),o(x,m)},$$slots:{default:!0}})});var He=n(Ge,2);g(He,()=>J,(_,h)=>{h(_,{class:"font-mono text-sm",children:(x,ge)=>{S();var m=pe();re(Fe=>P(m,Fe),[()=>zt(e(p).duration)]),o(x,m)},$$slots:{default:!0}})});var Ke=n(He,2);g(Ke,()=>J,(_,h)=>{h(_,{class:"font-mono text-sm text-muted-foreground",children:(x,ge)=>{S();var m=pe();re(()=>P(m,e(p).clientIP)),o(x,m)},$$slots:{default:!0}})});var Ye=n(Ke,2);g(Ye,()=>J,(_,h)=>{h(_,{class:"font-mono text-sm text-muted-foreground",children:(x,ge)=>{S();var m=pe();re(()=>P(m,e(p).serverName||"-")),o(x,m)},$$slots:{default:!0}})});var Qe=n(Ye,2);g(Qe,()=>J,(_,h)=>{h(_,{class:"font-mono text-sm text-muted-foreground",children:(x,ge)=>{S();var m=pe();re(()=>P(m,e(p).appVersion||"-")),o(x,m)},$$slots:{default:!0}})});var bt=n(Qe,2);g(bt,()=>J,(_,h)=>{h(_,{children:(x,ge)=>{Nt(x,{get scope(){return e(p).scope}})},$$slots:{default:!0}})}),o(Tt,Je)},$$slots:{default:!0}})})}o(ee,V)}),o(v,Z)};q(M,v=>{e(_e).length===0?v(N):v(X,!1)},!0)}o(y,D)};q(ce,y=>{e(U)?y(me):y(O,!1)})}o(ue,L)},$$slots:{default:!0}})}),o(B,C)},$$slots:{default:!0}})}),c(we);var xt=n(we,2);Et(xt,{get currentPage(){return e(G)},get totalPages(){return e(Ce)},get pageSize(){return e(De)},get totalItems(){return e(Be)},onPageChange:it,onPageSizeChange:dt,get loading(){return e(U)},itemLabel:"task"}),o(Y,ye)};q(i,Y=>{e(he)&&!e(U)?Y(ft):Y(vt,!1)},!0)}o(r,a)};q(ut,r=>{e($e)?r(ct):r(mt,!1)})}c(Re),o(Se,Re),wt()}export{kr as component,yr as universal};
