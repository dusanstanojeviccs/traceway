import{r as _t}from"../chunks/hp4PFHFv.js";import{a as ft,b as mt,p as Ve,e as pt,i as $t}from"../chunks/Cz_w3iUV.js";import{f as v,i as z,a as e,c as w,t as P,s as ae}from"../chunks/DRF5TCtt.js";import{p as gt,q as ht,a as kt,c as B,g as t,u as A,s,m as me,r as L,w as q,f as o,n as y,t as se}from"../chunks/BjAeDMBy.js";import{c as a}from"../chunks/g5lWU4bW.js";import{g as qe}from"../chunks/C3Sf7PJj.js";import{f as xt,b as Ge}from"../chunks/CDT9LSXp.js";import{g as bt}from"../chunks/BOe3pJkQ.js";import{B as Pt}from"../chunks/2wOyHH5q.js";import{C as pe,a as $e,b as ge}from"../chunks/CZ9m_hDi.js";import{C as he}from"../chunks/C2TvfYoV.js";import{C as ke}from"../chunks/kLTvEu21.js";import{c as Tt,d as wt,T as Je,e as Re,b as yt,a as Ae}from"../chunks/y6C-zUiM.js";import{L as Ct}from"../chunks/2O2paTqt.js";import{E as Ke}from"../chunks/CEa0NWkH.js";import{L as oe,C as St}from"../chunks/Be2xkbpT.js";import{S as It,a as jt,C as Rt}from"../chunks/DpDBTxqz.js";import{P as At}from"../chunks/DpxRarxq.js";import{c as De}from"../chunks/zDxND3qM.js";import{r as ze}from"../chunks/UIOQSdMs.js";import{T as Dt}from"../chunks/BXbwCwB2.js";import{A as zt}from"../chunks/BeZrX3YG.js";const Bt=!1,Lt=({params:le,url:g})=>{if(!ft.isAuthenticated)throw _t(302,"/login");return{task:le.task,taskId:le.taskId,preset:g.searchParams.get("preset")||null,from:g.searchParams.get("from")||null,to:g.searchParams.get("to")||null}},yr=Object.freeze(Object.defineProperty({__proto__:null,load:Lt,prerender:Bt},Symbol.toStringTag,{value:"Module"}));var Ot=v('<div class="flex items-center justify-center py-20"><!></div>'),Ft=v("<!> <!>",1),Ut=v('<hr class="border-border"/> <div><p class="mb-3 text-sm font-medium">Context (Scope)</p> <!></div>',1),Et=v('<div class="grid grid-cols-2 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5"><!> <!> <!> <!> <!></div> <!>',1),Mt=v("<!> <!>",1),Ht=v('<div class="flex items-center gap-2"><!> <!></div> <!>',1),Nt=v("View Full Exception <!>",1),Vt=v('<div class="mb-4 max-h-32 overflow-x-auto rounded-md bg-muted p-3"><pre class="font-mono text-sm whitespace-pre-wrap"> </pre></div> <!>',1),qt=v("<!> <!>",1),Gt=v('<div class="flex items-center gap-2"><!> <!></div> <!>',1),Jt=v("<!> <!> <!>",1),Kt=v('<div class="max-w-md truncate font-mono text-sm"> </div>'),Qt=v('<span class="text-xs text-muted-foreground"> </span>'),Wt=v('<span class="text-xs text-muted-foreground">-</span>'),Xt=v("<!> <!> <!>",1),Yt=v("<!> <!>",1),Zt=v("<!> <!>",1),er=v("<!> <!>",1),tr=v("<!> <!>",1),rr=v("<!> <!> <!> <!>",1),ar=v('<div class="space-y-6"><!> <!></div>');function Cr(le,g){gt(g,!0);const Be=A(bt);let i=me(null),xe=me(!0),ne=me(""),be=me(!1);async function Pe(){q(xe,!0),q(ne,""),q(be,!1);try{const h=await mt.post(`/tasks/${g.data.taskId}`,{},{projectId:Ve.currentProjectId??void 0});q(i,h,!0)}catch(h){console.error(h);const C=h;C.status===404?q(be,!0):q(ne,C.message||"Failed to load task details",!0)}finally{q(xe,!1)}}ht(()=>{Pe()});var Te=ar(),Le=B(Te);{let h=A(()=>decodeURIComponent(g.data.task)),C=A(()=>`Task ID: ${g.data.taskId}`),Q=A(()=>De(ze("/tasks/[task]",{task:encodeURIComponent(g.data.task)})));At(Le,{get title(){return t(h)},get subtitle(){return t(C)},get onBack(){return t(Q)}})}var Qe=s(Le,2);{var We=h=>{var C=Ot(),Q=B(C);Ct(Q,{size:"xlg"}),L(C),e(h,C)},Xe=h=>{var C=w(),Q=o(C);{var Ye=G=>{{let de=A(()=>De(ze("/tasks/[task]",{task:encodeURIComponent(g.data.task)})));Ke(G,{status:404,title:"Task Not Found",description:"The task instance you're looking for doesn't exist or may have expired.",get onBack(){return t(de)},backLabel:"Back to Task",onRetry:Pe,get identifier(){return g.data.taskId}})}},Ze=G=>{var de=w(),et=o(de);{var tt=J=>{{let ie=A(()=>De(ze("/tasks/[task]",{task:encodeURIComponent(g.data.task)})));Ke(J,{status:400,title:"Failed to Load Task",get description(){return t(ne)},get onBack(){return t(ie)},backLabel:"Back to Task",onRetry:Pe})}},rt=J=>{var ie=w(),at=o(ie);{var st=we=>{var Oe=rr(),Fe=o(Oe);a(Fe,()=>ge,(S,O)=>{O(S,{children:(V,W)=>{var F=Mt(),U=o(F);a(U,()=>pe,(k,x)=>{x(k,{children:(I,j)=>{var c=Ft(),u=o(c);a(u,()=>$e,(n,r)=>{r(n,{children:(d,b)=>{y();var _=P("Task Details");e(d,_)},$$slots:{default:!0}})});var T=s(u,2);a(T,()=>ke,(n,r)=>{r(n,{children:(d,b)=>{y();var _=P("Details of this specific task execution");e(d,_)},$$slots:{default:!0}})}),e(I,c)},$$slots:{default:!0}})});var X=s(U,2);a(X,()=>he,(k,x)=>{x(k,{class:"space-y-6",children:(I,j)=>{var c=Et(),u=o(c),T=B(u);{let l=A(()=>decodeURIComponent(g.data.task));oe(T,{label:"Task",get value(){return t(l)},mono:!0})}var n=s(T,2);{let l=A(()=>xt(t(i).task.duration));oe(n,{label:"Duration",get value(){return t(l)},mono:!0,large:!0})}var r=s(n,2);{let l=A(()=>Ge(t(i).task.recordedAt,{timezone:t(Be)}));oe(r,{label:"Recorded At",get value(){return t(l)},mono:!0})}var d=s(r,2);oe(d,{label:"Server",get value(){return t(i).task.serverName},mono:!0});var b=s(d,2);{let l=A(()=>t(i).task.appVersion||"-");oe(b,{label:"Version",get value(){return t(l)},mono:!0})}L(u);var _=s(u,2);{var $=l=>{var f=Ut(),p=s(o(f),2),m=s(B(p),2);St(m,{get scope(){return t(i).task.scope}}),L(p),e(l,f)};z(_,l=>{t(i).task.scope&&Object.keys(t(i).task.scope).length>0&&l($)})}e(I,c)},$$slots:{default:!0}})}),e(V,F)},$$slots:{default:!0}})});var Ue=s(Fe,2);{var ot=S=>{var O=w(),V=o(O);a(V,()=>ge,(W,F)=>{F(W,{class:"border-red-500/30 bg-red-500/5",children:(U,X)=>{var k=qt(),x=o(k);a(x,()=>pe,(j,c)=>{c(j,{children:(u,T)=>{var n=Ht(),r=o(n),d=B(r);Dt(d,{class:"h-5 w-5 text-red-500"});var b=s(d,2);a(b,()=>$e,($,l)=>{l($,{class:"text-red-600 dark:text-red-400",children:(f,p)=>{y();var m=P("Exception Occurred");e(f,m)},$$slots:{default:!0}})}),L(r);var _=s(r,2);a(_,()=>ke,($,l)=>{l($,{children:(f,p)=>{y();var m=P("This task execution resulted in an exception");e(f,m)},$$slots:{default:!0}})}),e(u,n)},$$slots:{default:!0}})});var I=s(x,2);a(I,()=>he,(j,c)=>{c(j,{children:(u,T)=>{var n=Vt(),r=o(n),d=B(r),b=B(d);L(d),L(r);var _=s(r,2);Pt(_,{variant:"outline",size:"sm",onclick:()=>qe(`/issues/${t(i).exception.exceptionHash}`),children:($,l)=>{y();var f=Nt(),p=s(o(f));zt(p,{class:"ml-2 h-4 w-4"}),e($,f)},$$slots:{default:!0}}),se(($,l)=>ae(b,`${$??""}${l??""}`),[()=>t(i).exception.stackTrace.split(`
`).slice(0,4).join(`
`),()=>t(i).exception.stackTrace.split(`
`).length>4?`
...`:""]),e(u,n)},$$slots:{default:!0}})}),e(U,k)},$$slots:{default:!0}})}),e(S,O)};z(Ue,S=>{t(i).exception&&S(ot)})}var Ee=s(Ue,2);{var lt=S=>{var O=w(),V=o(O);a(V,()=>ge,(W,F)=>{F(W,{children:(U,X)=>{var k=Zt(),x=o(k);a(x,()=>pe,(j,c)=>{c(j,{children:(u,T)=>{var n=Gt(),r=o(n),d=B(r);Rt(d,{class:"h-5 w-5 text-muted-foreground"});var b=s(d,2);a(b,()=>$e,($,l)=>{l($,{children:(f,p)=>{y();var m=P("Messages");e(f,m)},$$slots:{default:!0}})}),L(r);var _=s(r,2);a(_,()=>ke,($,l)=>{l($,{children:(f,p)=>{y();var m=P();se(()=>ae(m,`${t(i).messages.length??""} message${t(i).messages.length===1?"":"s"} logged during this task`)),e(f,m)},$$slots:{default:!0}})}),e(u,n)},$$slots:{default:!0}})});var I=s(x,2);a(I,()=>he,(j,c)=>{c(j,{class:"px-0 pb-0",children:(u,T)=>{var n=w(),r=o(n);a(r,()=>Tt,(d,b)=>{b(d,{children:(_,$)=>{var l=Yt(),f=o(l);a(f,()=>wt,(m,ye)=>{ye(m,{children:(Ce,dt)=>{var Y=w(),Se=o(Y);a(Se,()=>Je,(Ie,D)=>{D(Ie,{children:(ve,Me)=>{var ce=Jt(),ue=o(ce);a(ue,()=>Re,(M,H)=>{H(M,{class:"pl-6",children:(N,fe)=>{y();var R=P("Message");e(N,R)},$$slots:{default:!0}})});var _e=s(ue,2);a(_e,()=>Re,(M,H)=>{H(M,{class:"w-[180px]",children:(N,fe)=>{y();var R=P("Recorded At");e(N,R)},$$slots:{default:!0}})});var He=s(_e,2);a(He,()=>Re,(M,H)=>{H(M,{class:"w-[100px] pr-6",children:(N,fe)=>{y();var R=P("Scope");e(N,R)},$$slots:{default:!0}})}),e(ve,ce)},$$slots:{default:!0}})}),e(Ce,Y)},$$slots:{default:!0}})});var p=s(f,2);a(p,()=>yt,(m,ye)=>{ye(m,{children:(Ce,dt)=>{var Y=w(),Se=o(Y);pt(Se,17,()=>t(i).messages,$t,(Ie,D)=>{var ve=w(),Me=o(ve);a(Me,()=>Je,(ce,ue)=>{ue(ce,{class:"cursor-pointer hover:bg-muted/50",onclick:()=>qe(`/issues/${t(D).exceptionHash}/${t(D).id}`),children:(_e,He)=>{var M=Xt(),H=o(M);a(H,()=>Ae,(R,Z)=>{Z(R,{class:"pl-6",children:(ee,Ne)=>{var E=Kt(),te=B(E,!0);L(E),se(je=>ae(te,je),[()=>t(D).stackTrace.split(`
`)[0]]),e(ee,E)},$$slots:{default:!0}})});var N=s(H,2);a(N,()=>Ae,(R,Z)=>{Z(R,{class:"font-mono text-sm text-muted-foreground",children:(ee,Ne)=>{y();var E=P();se(te=>ae(E,te),[()=>Ge(t(D).recordedAt,{timezone:t(Be)})]),e(ee,E)},$$slots:{default:!0}})});var fe=s(N,2);a(fe,()=>Ae,(R,Z)=>{Z(R,{class:"pr-6",children:(ee,Ne)=>{var E=w(),te=o(E);{var je=K=>{var re=Qt(),vt=B(re);L(re),se((ct,ut)=>ae(vt,`${ct??""} key${ut??""}`),[()=>Object.keys(t(D).scope).length,()=>Object.keys(t(D).scope).length===1?"":"s"]),e(K,re)},it=K=>{var re=Wt();e(K,re)};z(te,K=>{t(D).scope&&Object.keys(t(D).scope).length>0?K(je):K(it,!1)})}e(ee,E)},$$slots:{default:!0}})}),e(_e,M)},$$slots:{default:!0}})}),e(Ie,ve)}),e(Ce,Y)},$$slots:{default:!0}})}),e(_,l)},$$slots:{default:!0}})}),e(u,n)},$$slots:{default:!0}})}),e(U,k)},$$slots:{default:!0}})}),e(S,O)};z(Ee,S=>{t(i).messages.length>0&&S(lt)})}var nt=s(Ee,2);a(nt,()=>ge,(S,O)=>{O(S,{children:(V,W)=>{var F=tr(),U=o(F);a(U,()=>pe,(k,x)=>{x(k,{children:(I,j)=>{var c=er(),u=o(c);a(u,()=>$e,(n,r)=>{r(n,{children:(d,b)=>{y();var _=P("Segments");e(d,_)},$$slots:{default:!0}})});var T=s(u,2);a(T,()=>ke,(n,r)=>{r(n,{children:(d,b)=>{var _=w(),$=o(_);{var l=p=>{var m=P("Timing breakdown of operations within this task");e(p,m)},f=p=>{var m=P("No segments recorded for this task");e(p,m)};z($,p=>{t(i).hasSegments?p(l):p(f,!1)})}e(d,_)},$$slots:{default:!0}})}),e(I,c)},$$slots:{default:!0}})});var X=s(U,2);a(X,()=>he,(k,x)=>{x(k,{children:(I,j)=>{var c=w(),u=o(c);{var T=r=>{It(r,{get segments(){return t(i).segments},get transactionDuration(){return t(i).task.duration},get transactionStartTime(){return t(i).task.recordedAt}})},n=r=>{{let d=A(()=>Ve.currentProject?.framework??"gin");jt(r,{get framework(){return t(d)}})}};z(u,r=>{t(i).hasSegments?r(T):r(n,!1)})}e(I,c)},$$slots:{default:!0}})}),e(V,F)},$$slots:{default:!0}})}),e(we,Oe)};z(at,we=>{t(i)&&we(st)},!0)}e(J,ie)};z(et,J=>{t(ne)?J(tt):J(rt,!1)},!0)}e(G,de)};z(Q,G=>{t(be)?G(Ye):G(Ze,!1)},!0)}e(h,C)};z(Qe,h=>{t(xe)?h(We):h(Xe,!1)})}L(Te),e(le,Te),kt()}export{Cr as component,yr as universal};
