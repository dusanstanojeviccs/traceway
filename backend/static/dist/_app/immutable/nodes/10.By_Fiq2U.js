import{r as vt}from"../chunks/hp4PFHFv.js";import{a as ut,b as De,p as Ee,e as ft,i as pt}from"../chunks/Cz_w3iUV.js";import{f,i as _,a as r,b as mt,c as l,t as W,s as te}from"../chunks/DRF5TCtt.js";import{p as _t,m as d,h as gt,q as ht,f as a,a as $t,c as q,w as o,g as e,s as v,n as b,r as G,u as re,t as ae}from"../chunks/BjAeDMBy.js";import{c as n}from"../chunks/g5lWU4bW.js";import{p as J}from"../chunks/BD7i_QTQ.js";import{g as Re}from"../chunks/C3Sf7PJj.js";import{c as ye}from"../chunks/zDxND3qM.js";import{d as xt,b as bt}from"../chunks/CDT9LSXp.js";import{g as Pt}from"../chunks/BOe3pJkQ.js";import{B as Fe}from"../chunks/2wOyHH5q.js";import{C as yt,a as kt,b as wt}from"../chunks/CZ9m_hDi.js";import{C as Tt}from"../chunks/kLTvEu21.js";import{b as St,d as Ct,T as ke,a as oe,c as zt}from"../chunks/y6C-zUiM.js";import{L as Me}from"../chunks/2O2paTqt.js";import{E as Ne}from"../chunks/CEa0NWkH.js";import{a as we,T as It}from"../chunks/PdIRTCrQ.js";import{P as jt}from"../chunks/BUOTwRzw.js";import{A as At}from"../chunks/DPmphkir.js";import{r as Oe}from"../chunks/UIOQSdMs.js";import{t as Ht}from"../chunks/DJXxIydW.js";import{A as Bt}from"../chunks/ClEYWht3.js";const Lt=!1,Dt=({params:se})=>{if(!ut.isAuthenticated)throw vt(302,"/login");return{exceptionHash:se.exceptionHash}},_r=Object.freeze(Object.defineProperty({__proto__:null,load:Dt,prerender:Lt},Symbol.toStringTag,{value:"Module"}));var Et=mt('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg> Back to Issue',1),Rt=f("<!> Archive",1),Ft=f('<div class="flex items-center justify-center py-20"><!></div>'),Mt=f("<!> <!>",1),Nt=f("<!> <!> <!>",1),Ot=f('<div class="flex items-center justify-center"><!></div>'),Wt=f("<!> <!> <!>",1),qt=f("<!> <!>",1),Gt=f('<!> <div class="rounded-md border overflow-hidden"><!></div> <!>',1),Jt=f('<div class="space-y-6"><div class="flex items-center justify-between"><!> <!></div> <!></div> <!>',1);function gr(se,We){_t(We,!0);const qe=re(Pt);let j=d(null),A=d(gt([])),P=d(!0),K=d(""),ne=d(!1),ie=d(!1),le=d(!1),Q=d(1),ce=d(20),Te=d(0),de=d(0);async function H(){o(P,!0),o(K,""),o(ne,!1);try{const t=J.params.exceptionHash,s=await De.post(`/exception-stack-traces/${t}`,{pagination:{page:e(Q),pageSize:e(ce)}},{projectId:Ee.currentProjectId??void 0});o(j,s.group,!0),o(A,s.occurrences||[],!0),o(Te,s.pagination.total,!0),o(de,s.pagination.totalPages,!0)}catch(t){console.error(t),t.status===404?o(ne,!0):o(K,t.message||"Failed to load exception details",!0)}finally{o(P,!1)}}function Ge(t){t>=1&&t<=e(de)&&(o(Q,t,!0),H())}function Je(t){o(ce,t,!0),o(Q,1),H()}async function Ke(){o(le,!0);try{await De.post("/exception-stack-traces/archive",{hashes:[J.params.exceptionHash]},{projectId:Ee.currentProjectId??void 0}),Ht.success("Successfully archived the Issue"),Re("/issues")}catch(t){throw console.error("Archive failed:",t),t}finally{o(le,!1)}}ht(()=>{H()});var Se=Jt(),ve=a(Se),ue=q(ve),Ce=q(ue);Fe(Ce,{variant:"outline",size:"sm",onclick:()=>Re(`/issues/${J.params.exceptionHash}`),children:(t,s)=>{var y=Et();b(),r(t,y)},$$slots:{default:!0}});var Qe=v(Ce,2);{var Ue=t=>{Fe(t,{variant:"outline",size:"sm",onclick:()=>o(ie,!0),get disabled(){return e(le)},class:"gap-1.5",children:(s,y)=>{var U=Rt(),fe=a(U);Bt(fe,{class:"h-4 w-4"}),b(),r(s,U)},$$slots:{default:!0}})};_(Qe,t=>{e(j)&&t(Ue)})}G(ue);var Ve=v(ue,2);{var Xe=t=>{var s=Ft(),y=q(s);Me(y,{size:"xlg"}),G(s),r(t,s)},Ye=t=>{var s=l(),y=a(s);{var U=k=>{{let V=re(()=>ye(Oe("/issues"),"presets","from","to"));Ne(k,{status:404,title:"Exception Not Found",description:"The exception you're looking for doesn't exist or may have been removed.",get onBack(){return e(V)},backLabel:"Back to Issues",onRetry:()=>H(),get identifier(){return J.params.exceptionHash}})}},fe=k=>{var V=l(),et=a(V);{var tt=w=>{{let X=re(()=>ye(Oe("/issues"),"presets","from","to"));Ne(w,{status:400,title:"Something Went Wrong",get description(){return e(K)},get onBack(){return e(X)},backLabel:"Back to Issues",onRetry:()=>H()})}},rt=w=>{var X=l(),at=a(X);{var ot=pe=>{var ze=Gt(),Ie=a(ze);n(Ie,()=>wt,(_e,ge)=>{ge(_e,{children:(he,it)=>{var B=l(),Y=a(B);n(Y,()=>yt,($e,xe)=>{xe($e,{class:"pb-3",children:(g,L)=>{var T=Mt(),D=a(T);n(D,()=>kt,(h,C)=>{C(h,{class:"text-lg",children:(p,u)=>{b();var i=W("All Events");r(p,i)},$$slots:{default:!0}})});var S=v(D,2);n(S,()=>Tt,(h,C)=>{C(h,{class:"font-mono text-sm",children:(p,u)=>{b();var i=W();ae($=>te(i,$),[()=>xt(e(j).stackTrace,80)]),r(p,i)},$$slots:{default:!0}})}),r(g,T)},$$slots:{default:!0}})}),r(he,B)},$$slots:{default:!0}})});var me=v(Ie,2),st=q(me);n(st,()=>zt,(_e,ge)=>{ge(_e,{children:(he,it)=>{var B=qt(),Y=a(B);{var $e=g=>{var L=l(),T=a(L);n(T,()=>Ct,(D,S)=>{S(D,{children:(h,C)=>{var p=l(),u=a(p);n(u,()=>ke,(i,$)=>{$(i,{children:(E,Z)=>{var c=Nt(),z=a(c);we(z,{label:"Recorded At",tooltip:"When this occurrence was recorded"});var x=v(z,2);we(x,{label:"Server",tooltip:"Server instance where error occurred"});var R=v(x,2);we(R,{label:"Transaction",tooltip:"Transaction ID if this occurred during a request"}),r(E,c)},$$slots:{default:!0}})}),r(h,p)},$$slots:{default:!0}})}),r(g,L)};_(Y,g=>{(e(P)||e(A).length>0)&&g($e)})}var xe=v(Y,2);n(xe,()=>St,(g,L)=>{L(g,{children:(T,D)=>{var S=l(),h=a(S);{var C=u=>{var i=l(),$=a(i);n($,()=>ke,(E,Z)=>{Z(E,{children:(c,z)=>{var x=l(),R=a(x);n(R,()=>oe,(I,ee)=>{ee(I,{colspan:3,class:"h-48",children:(be,je)=>{var F=Ot(),Pe=q(F);Me(Pe,{size:"lg"}),G(F),r(be,F)},$$slots:{default:!0}})}),r(c,x)},$$slots:{default:!0}})}),r(u,i)},p=u=>{var i=l(),$=a(i);{var E=c=>{It(c,{colspan:3,message:"No events found."})},Z=c=>{var z=l(),x=a(z);ft(x,17,()=>e(A),pt,(R,I)=>{var ee=l(),be=a(ee);{let je=re(()=>ye(`/issues/${J.params.exceptionHash}/${e(I).id}`));n(be,()=>ke,(F,Pe)=>{Pe(F,{class:"cursor-pointer hover:bg-muted/50",get onclick(){return e(je)},children:(lt,Kt)=>{var Ae=Wt(),He=a(Ae);n(He,()=>oe,(M,N)=>{N(M,{children:(O,Le)=>{b();var m=W();ae(dt=>te(m,dt),[()=>bt(e(I).recordedAt,{timezone:e(qe)})]),r(O,m)},$$slots:{default:!0}})});var Be=v(He,2);n(Be,()=>oe,(M,N)=>{N(M,{class:"font-mono text-sm text-muted-foreground",children:(O,Le)=>{b();var m=W();ae(()=>te(m,e(I).serverName||"-")),r(O,m)},$$slots:{default:!0}})});var ct=v(Be,2);n(ct,()=>oe,(M,N)=>{N(M,{class:"font-mono text-sm",children:(O,Le)=>{b();var m=W();ae(()=>te(m,e(I).transactionId||"-")),r(O,m)},$$slots:{default:!0}})}),r(lt,Ae)},$$slots:{default:!0}})})}r(R,ee)}),r(c,z)};_($,c=>{e(A).length===0?c(E):c(Z,!1)},!0)}r(u,i)};_(h,u=>{e(P)?u(C):u(p,!1)})}r(T,S)},$$slots:{default:!0}})}),r(he,B)},$$slots:{default:!0}})}),G(me);var nt=v(me,2);jt(nt,{get currentPage(){return e(Q)},get totalPages(){return e(de)},get pageSize(){return e(ce)},get totalItems(){return e(Te)},get itemsShown(){return e(A).length},onPageChange:Ge,onPageSizeChange:Je,get loading(){return e(P)},itemLabel:"event"}),r(pe,ze)};_(at,pe=>{e(j)&&pe(ot)},!0)}r(w,X)};_(et,w=>{e(K)?w(tt):w(rt,!1)},!0)}r(k,V)};_(y,k=>{e(ne)?k(U):k(fe,!1)},!0)}r(t,s)};_(Ve,t=>{e(P)&&!e(j)?t(Xe):t(Ye,!1)})}G(ve);var Ze=v(ve,2);At(Ze,{get open(){return e(ie)},onOpenChange:t=>o(ie,t,!0),count:1,onConfirm:Ke}),r(se,Se),$t()}export{gr as component,_r as universal};
